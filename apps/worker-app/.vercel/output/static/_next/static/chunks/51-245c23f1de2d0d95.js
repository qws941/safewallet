"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[51],{5140:function(e,t,r){r.d(t,{h:function(){return a}});var n=r(7573),o=r(8368);function a(){let{currentSiteId:e}=(0,o.a)();return(0,n.jsx)("header",{className:"sticky top-0 z-40 bg-white border-b border-gray-200 safe-top",children:(0,n.jsxs)("div",{className:"flex items-center justify-between h-14 px-4",children:[(0,n.jsx)("h1",{className:"text-lg font-bold text-primary",children:"안전지갑"}),e&&(0,n.jsxs)("span",{className:"text-sm text-muted-foreground",children:["현장 ID: ",e.slice(0,8)]})]})})}},189:function(e,t,r){r.d(t,{Un:function(){return l},_g:function(){return f},fj:function(){return c},kx:function(){return s},uV:function(){return u},xt:function(){return d}});var n=r(1988),o=r(7930),a=r(5969),i=r(5118);function s(e){return(0,n.a)({queryKey:["posts",e],queryFn:()=>(0,i.S)("/posts?siteId=".concat(e)),enabled:!!e})}function u(e){return(0,n.a)({queryKey:["post",e],queryFn:()=>(0,i.S)("/posts/".concat(e)),enabled:!!e})}function c(){let e=(0,o.NL)();return(0,a.D)({mutationFn:e=>(0,i.S)("/posts",{method:"POST",body:JSON.stringify(e)}),onSuccess:(t,r)=>{e.invalidateQueries({queryKey:["posts",r.siteId]})}})}function l(){return(0,n.a)({queryKey:["profile"],queryFn:()=>(0,i.S)("/users/me")})}function d(e){return(0,n.a)({queryKey:["points",e],queryFn:()=>(0,i.S)("/points?siteId=".concat(e)),enabled:!!e})}function f(e){return(0,n.a)({queryKey:["announcements",e],queryFn:()=>(0,i.S)("/announcements?siteId=".concat(e)),enabled:!!e})}},8368:function(e,t,r){r.d(t,{a:function(){return o}});var n=r(8144);function o(){let{user:e,isAuthenticated:t,currentSiteId:r,login:o,logout:a,setCurrentSite:i}=(0,n.t)();return{user:e,isAuthenticated:t,currentSiteId:r,login:o,logout:a,setCurrentSite:i}}},5118:function(e,t,r){r.d(t,{S:function(){return a}});var n=r(8144);let o=r(4859).env.NEXT_PUBLIC_API_URL||"http://localhost:3333";async function a(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{skipAuth:r=!1,headers:a,...u}=t,c={"Content-Type":"application/json",...a};if(!r){let e=n.t.getState().accessToken;e&&(c.Authorization="Bearer ".concat(e))}let l=await fetch("".concat(o).concat(e),{...u,headers:c});if(401===l.status&&!r){if(await i()){let t=n.t.getState().accessToken;c.Authorization="Bearer ".concat(t);let r=await fetch("".concat(o).concat(e),{...u,headers:c});if(!r.ok)throw new s(r.status,await r.text());return r.json()}throw n.t.getState().logout(),new s(401,"Session expired")}if(!l.ok)throw new s(l.status,await l.text());return l.json()}async function i(){let e=n.t.getState().refreshToken;if(!e)return!1;try{let t=await fetch("".concat(o,"/auth/refresh"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refreshToken:e})});if(!t.ok)return!1;let r=await t.json();return n.t.getState().setTokens(r.data.accessToken,r.data.refreshToken),!0}catch(e){return!1}}class s extends Error{constructor(e,t){super(t),this.status=e,this.name="ApiError"}}},8144:function(e,t,r){r.d(t,{t:function(){return a}});var n=r(8321),o=r(4452);let a=(0,n.U)()((0,o.tJ)(e=>({user:null,accessToken:null,refreshToken:null,isAuthenticated:!1,currentSiteId:null,setUser:t=>e({user:t}),setTokens:(t,r)=>e({accessToken:t,refreshToken:r}),setCurrentSite:t=>e({currentSiteId:t}),login:(t,r,n)=>e({user:t,accessToken:r,refreshToken:n,isAuthenticated:!0}),logout:()=>e({user:null,accessToken:null,refreshToken:null,isAuthenticated:!1,currentSiteId:null})}),{name:"safetywallet-auth",storage:(0,o.FL)(()=>localStorage),partialize:e=>({user:e.user,accessToken:e.accessToken,refreshToken:e.refreshToken,isAuthenticated:e.isAuthenticated,currentSiteId:e.currentSiteId})}))},5363:function(e,t){Object.defineProperty(t,"__esModule",{value:!0})},8658:function(e,t){Object.defineProperty(t,"__esModule",{value:!0})},8536:function(e,t){Object.defineProperty(t,"__esModule",{value:!0})},4602:function(e,t){Object.defineProperty(t,"__esModule",{value:!0})},6183:function(e,t,r){var n=Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);(!o||("get"in o?!t.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]},o=function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),o(r(4602),t),o(r(3700),t),o(r(6668),t),o(r(5769),t),o(r(2232),t),o(r(1098),t),o(r(8658),t),o(r(8536),t)},1098:function(e,t){Object.defineProperty(t,"__esModule",{value:!0})},5769:function(e,t){Object.defineProperty(t,"__esModule",{value:!0})},2232:function(e,t){Object.defineProperty(t,"__esModule",{value:!0})},6668:function(e,t){Object.defineProperty(t,"__esModule",{value:!0})},3700:function(e,t){Object.defineProperty(t,"__esModule",{value:!0})},9633:function(e,t){var r,n,o,a,i,s,u,c,l,d,f,E,p,b,g,N,y,R,v,m;Object.defineProperty(t,"__esModule",{value:!0}),t.RejectReason=t.TaskStatus=t.ReviewAction=t.ActionStatus=t.ReviewStatus=t.Visibility=t.RiskLevel=t.Category=t.MembershipStatus=t.UserRole=void 0,(f=r||(t.UserRole=r={})).WORKER="WORKER",f.SITE_ADMIN="SITE_ADMIN",f.SUPER_ADMIN="SUPER_ADMIN",f.SYSTEM="SYSTEM",(E=n||(t.MembershipStatus=n={})).PENDING="PENDING",E.ACTIVE="ACTIVE",E.LEFT="LEFT",E.REMOVED="REMOVED",(p=o||(t.Category=o={})).HAZARD="HAZARD",p.UNSAFE_BEHAVIOR="UNSAFE_BEHAVIOR",p.INCONVENIENCE="INCONVENIENCE",p.SUGGESTION="SUGGESTION",p.BEST_PRACTICE="BEST_PRACTICE",(b=a||(t.RiskLevel=a={})).HIGH="HIGH",b.MEDIUM="MEDIUM",b.LOW="LOW",(g=i||(t.Visibility=i={})).WORKER_PUBLIC="WORKER_PUBLIC",g.ADMIN_ONLY="ADMIN_ONLY",(N=s||(t.ReviewStatus=s={})).RECEIVED="RECEIVED",N.IN_REVIEW="IN_REVIEW",N.NEED_INFO="NEED_INFO",N.APPROVED="APPROVED",N.REJECTED="REJECTED",(y=u||(t.ActionStatus=u={})).NONE="NONE",y.REQUIRED="REQUIRED",y.ASSIGNED="ASSIGNED",y.IN_PROGRESS="IN_PROGRESS",y.DONE="DONE",y.REOPENED="REOPENED",(R=c||(t.ReviewAction=c={})).APPROVE="APPROVE",R.REJECT="REJECT",R.REQUEST_MORE="REQUEST_MORE",R.MARK_URGENT="MARK_URGENT",R.ASSIGN="ASSIGN",R.CLOSE="CLOSE",(v=l||(t.TaskStatus=l={})).OPEN="OPEN",v.IN_PROGRESS="IN_PROGRESS",v.DONE="DONE",(m=d||(t.RejectReason=d={})).DUPLICATE="DUPLICATE",m.UNCLEAR_PHOTO="UNCLEAR_PHOTO",m.INSUFFICIENT="INSUFFICIENT",m.FALSE="FALSE",m.IRRELEVANT="IRRELEVANT",m.OTHER="OTHER"},3212:function(e,t,r){var n=Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);(!o||("get"in o?!t.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]},o=function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),o(r(9633),t),o(r(5363),t),o(r(6183),t)},2384:function(e,t,r){r.d(t,{qE:function(){return v},Q5:function(){return m},Ct:function(){return y},zx:function(){return l},Zb:function(){return d},aY:function(){return b},SZ:function(){return p},Ol:function(){return f},ll:function(){return E},II:function(){return g},Od:function(){return R},cn:function(){return a}});var n=r(607),o=r(5579);function a(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,o.m6)((0,n.W)(t))}var i=r(7573),s=r(7653),u=r(9289);let c=(0,u.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),l=s.forwardRef((e,t)=>{let{className:r,variant:n,size:o,...s}=e;return(0,i.jsx)("button",{className:a(c({variant:n,size:o,className:r})),ref:t,...s})});l.displayName="Button";let d=s.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,i.jsx)("div",{ref:t,className:a("rounded-lg border bg-card text-card-foreground shadow-sm",r),...n})});d.displayName="Card";let f=s.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,i.jsx)("div",{ref:t,className:a("flex flex-col space-y-1.5 p-6",r),...n})});f.displayName="CardHeader";let E=s.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,i.jsx)("h3",{ref:t,className:a("text-2xl font-semibold leading-none tracking-tight",r),...n})});E.displayName="CardTitle";let p=s.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,i.jsx)("p",{ref:t,className:a("text-sm text-muted-foreground",r),...n})});p.displayName="CardDescription";let b=s.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,i.jsx)("div",{ref:t,className:a("p-6 pt-0",r),...n})});b.displayName="CardContent",s.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,i.jsx)("div",{ref:t,className:a("flex items-center p-6 pt-0",r),...n})}).displayName="CardFooter";let g=s.forwardRef((e,t)=>{let{className:r,type:n,...o}=e;return(0,i.jsx)("input",{type:n,className:a("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",r),ref:t,...o})});g.displayName="Input";let N=(0,u.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground",secondary:"border-transparent bg-secondary text-secondary-foreground",destructive:"border-transparent bg-destructive text-destructive-foreground",outline:"text-foreground",success:"border-transparent bg-success text-success-foreground",warning:"border-transparent bg-warning text-warning-foreground",info:"border-transparent bg-blue-500 text-white",neutral:"border-transparent bg-gray-500 text-white"}},defaultVariants:{variant:"default"}});function y(e){let{className:t,variant:r,...n}=e;return(0,i.jsx)("div",{className:a(N({variant:r}),t),...n})}function R(e){let{className:t,...r}=e;return(0,i.jsx)("div",{className:a("animate-pulse rounded-md bg-muted",t),...r})}let v=s.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,i.jsx)("span",{ref:t,className:a("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",r),...n})});v.displayName="Avatar",s.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,i.jsx)("img",{ref:t,className:a("aspect-square h-full w-full",r),...n})}).displayName="AvatarImage";let m=s.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,i.jsx)("span",{ref:t,className:a("flex h-full w-full items-center justify-center rounded-full bg-muted",r),...n})});m.displayName="AvatarFallback"}}]);